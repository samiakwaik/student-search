<!DOCTYPE html>
<html lang="ar">
<head>
<meta charset="UTF-8">
<title>البحث عن حساب الطالبة</title>
<style>
body {font-family: 'Cairo', sans-serif; text-align: center; margin-top: 60px;}
input, button {
  padding: 10px; font-size: 16px; margin: 5px;
}
#result {margin-top: 25px; font-size: 18px; color: #333;}
</style>
</head>
<body>

<h2>🔍 البحث عن حساب الطالبة</h2>
<p>أدخلي رقم الهوية:</p>
<input type="text" id="searchInput" placeholder="مثال: 456">
<button onclick="searchStudent()">بحث</button>

<div id="result"></div>

<script>
async function searchStudent() {
  const input = document.getElementById("searchInput").value.trim();
  const resultDiv = document.getElementById("result");
  resultDiv.textContent = "جاري البحث...";

  // 📋 هذا هو رابط Google Sheet مع التنسيق الصحيح
  const sheetID = "1Jt_C4olgKgKjl2JrAD3wuZ7uf-Og2Ktn"; // ← تأكدي من أن هذا هو الـ ID الصحيح من الرابط
  const sheetName = "Sheet1";
  
  // ⭐️⭐️ هذا هو السطر المصحح ⭐️⭐️
  const sheetURL = `https://docs.google.com/spreadsheets/d/${sheetID}/gviz/tq?tqx=out:json&sheet=${sheetName}`;

  try {
    const res = await fetch(sheetURL);
    const text = await res.text();
    // إزالة Wrapper JSONP
    const json = JSON.parse(text.substr(47).slice(0, -2)); 
    const rows = json.table.rows;

    let found = false;
    for (const row of rows) {
      // نستخدم .c[0] لأن العمود الأول هو ID (تجاهل الصف Header)
      const id = row.c[0]?.v; 
      const username = row.c[1]?.v; 
      const password = row.c[2]?.v; 

      if (id == input) {
        resultDiv.innerHTML = `
          <b>✅ تم العثور على الحساب:</b><br>
          <b>📧 اسم المستخدم:</b> ${username}<br>
          <b>🔑 كلمة المرور:</b> ${password}
        `;
        found = true;
        break;
      }
    }

    if (!found) resultDiv.textContent = "❌ لم يتم العثور على رقم الهوية المدخل.";
  } catch (err) {
    // هذه الرسالة تظهر إذا فشل جلب البيانات (بسبب الرابط أو إعدادات المشاركة)
    resultDiv.textContent = "⚠ حدث خطأ أثناء جلب البيانات. تأكدي من إعدادات المشاركة والرابط.";
    console.error(err);
  }
}
</script>

</body>
</html>